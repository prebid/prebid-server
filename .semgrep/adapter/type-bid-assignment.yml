rules:
  - id: type-bid-assignment-check
    languages:
      - go
    message: >
      Found incorrect assignment made to `Bid` Consider using `seatBids.Bid` loop index as shown below  

      ```
        for _, seatBid := range response.SeatBid {
          for i, _ := range seatBids.Bid {
            ...
            responseBid := &adapters.TypedBid{
              Bid: &seatBids.Bid[i],
              ...
            }
            ...
            ...
          }
        }
      ```
    severity: ERROR
    patterns:
      - pattern-either:
          - pattern: >
              for _, $BID := range ... {
                ...
                ... := &adapters.TypedBid{
                  $KEY: &$BID,
                  ...
                }
                ...
              }
          - pattern: >
              for _, $BID := range ... {
                ...
                ... = adapters.TypedBid{
                  $KEY: &$BID,
                  ...
                }
                ...
              } 
          - pattern: >
              for _, $BID := range ... {
                ...
                ... = append(...,  &adapters.TypedBid{
                  $KEY: &$BID,
                  ...
                })
                ...
              }
          - pattern: >
              for _, $BID := range ... {
                var $TYPEBID_OBJ adapters.TypedBid
                ...
                $TYPEBID_OBJ. $KEY = &$BID
                ...
              }                              
      - focus-metavariable: $KEY
      - metavariable-regex:
          metavariable: $KEY
          regex: Bid
